#include <SDL2/SDL.h>
#include <stdio.h>

#define SCREEN_WIDTH 800
#define SCREEN_HEIGHT 600

typedef struct {
    SDL_Rect rect;
    const char* label;
} Button;

typedef struct {
    int positions[4][2];
} GameState;

void drawButton(SDL_Renderer* renderer, Button* button) {
    SDL_SetRenderDrawColor(renderer, 0, 128, 255, 255);
    SDL_RenderFillRect(renderer, &button->rect);

}

void saveGameState(const GameState* state) {
    FILE* file = fopen("game_save.txt", "w");
    if (!file) {
        printf("Erreur lors de l'ouverture du fichier pour la sauvegarde.\n");
        return;
    }
    for (int i = 0; i < 4; i++) {
        fprintf(file, "Joueur %d: Position (%d, %d)\n", i + 1, state->positions[i][0], state->positions[i][1]);
    }

    fclose(file);  // Fermer le fichier
    printf("Jeu sauvegardé avec succès !\n");
}
int main(int argc, char* argv[]) {
    if (SDL_Init(SDL_INIT_VIDEO) < 0) {
        printf("SDL_Init a échoué: %s\n", SDL_GetError());
        return 1;
    }
    SDL_Window * window = SDL_CreateWindow("Jeu Quoridor - Sauvegarde",
                                          SDL_WINDOWPOS_UNDEFINED, SDL_WINDOWPOS_UNDEFINED,
                                          SCREEN_WIDTH, SCREEN_HEIGHT,
                                          SDL_WINDOW_SHOWN);
    if (!window) {
        printf("SDL_CreateWindow a échoué: %s\n", SDL_GetError());
        SDL_Quit();
        return 1;
    }
    SDL_Renderer* renderer = SDL_CreateRenderer(window, -1, SDL_RENDERER_ACCELERATED);
    if (!renderer) {
        printf("SDL_CreateRenderer a échoué: %s\n", SDL_GetError());
        SDL_DestroyWindow(window);
        SDL_Quit();
        return 1;
    }
    Button saveButton = { {SCREEN_WIDTH / 2 - 100, SCREEN_HEIGHT / 2 - 50, 200, 100}, "Sauvegarder" };
    GameState gameState = {
        {{8, 0}, {0, 8}, {0, 0}, {8, 8}}
    };

    int running = 1;
    while (running) {
        SDL_Event event;
        while (SDL_PollEvent(&event)) {
            if (event.type == SDL_QUIT) {
                running = 0;
            }
            if (event.type == SDL_MOUSEBUTTONDOWN) {
                int x = event.button.x;
                int y = event.button.y;

                if (x >= saveButton.rect.x && x <= saveButton.rect.x + saveButton.rect.w &&
                    y >= saveButton.rect.y && y <= saveButton.rect.y + saveButton.rect.h) {
                    saveGameState(&gameState);
                }
            }
        }
        SDL_SetRenderDrawColor(renderer, 0, 0, 0, 255);
        SDL_RenderClear(renderer);

        drawButton(renderer, &saveButton);
        SDL_RenderPresent(renderer);
        SDL_Delay(100);
    }
    SDL_DestroyRenderer(renderer);
    SDL_DestroyWindow(window);
    SDL_Quit();
    return 0;
}
